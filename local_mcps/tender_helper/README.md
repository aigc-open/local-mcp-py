# 标书生成助手

## 概述

标书生成助手是一个专门用于生成各种类型标书文档的MCP工具集。它支持完整的标书编写流程：从大纲生成、内容编写到最终的Word文档导出，特别适合需要分章节管理和协作编写的标书项目。

## 功能特性

### 🎯 完整的标书编写流程

#### 1. 标书大纲生成器 (`tender_outline_generator`)
- **智能大纲生成**：根据招标需求生成专业的标书大纲
- **多种标书类型**：支持工程类、服务类、货物类、技术类等
- **结构化输出**：JSON格式的大纲，包含章节编号、标题、内容要点等
- **评分权重标注**：标注重点章节和评分权重

#### 2. 大纲调整优化器 (`tender_outline_adjuster`)
- **灵活调整**：支持增加、删除、修改、重排章节
- **保持规范性**：确保调整后的大纲符合标书规范
- **逻辑完整性**：维护章节间的逻辑关系和依赖关系

#### 3. 标书内容生成器 (`tender_content_generator`)
- **专业内容生成**：根据大纲生成详细的标书内容
- **多种内容类型**：技术标、商务标、资格证明等
- **突出优势**：生成有说服力的投标内容
- **符合规范**：遵循标书编写规范和格式要求

### 📁 文件管理系统

#### 4. 项目结构创建器 (`create_tender_project_structure`)
- **自动创建项目结构**：根据大纲创建完整的文件目录
- **分章节管理**：每个章节对应一个独立的Markdown文件
- **附件管理**：支持证书、案例、图片等附件管理
- **状态跟踪**：跟踪各章节的编写进度

#### 5. 章节合并器 (`merge_tender_chapters`)
- **智能合并**：将所有章节合并为完整的标书文档
- **进度统计**：统计完成进度和文档字数
- **格式统一**：确保合并后文档格式的一致性

### 📄 Word文档导出

#### 6. Word导出器 (`export_tender_to_word`)
- **专业格式**：转换为符合标书规范的Word文档
- **样式模板**：提供标准、专业、政府采购等样式模板
- **自动排版**：自动生成目录、页码、页眉页脚
- **表格图片**：正确处理表格和图片格式

## 项目文件结构

```
tender_项目名称/
├── outline.json              # 标书大纲文件
├── project_status.json       # 项目状态跟踪
├── chapters/                 # 章节内容目录
│   ├── 01_投标函及投标函附录.md
│   ├── 02_技术方案.md
│   ├── 03_实施计划.md
│   ├── 04_质量保证.md
│   ├── 05_商务标.md
│   └── ...
├── attachments/              # 附件目录
│   ├── certificates/         # 证书文件
│   ├── cases/               # 案例材料
│   └── images/              # 图片文件
└── output/                  # 输出目录
    ├── tender_full.md       # 合并后的完整文档
    ├── tender_full.docx     # Word格式文档
    └── convert_to_word.py   # Word转换脚本
```

## 使用方法

### 1. 作为独立服务运行
```bash
python -m local_mcps.cli tender_helper
```

### 2. 集成到主服务中运行
```bash
python -m local_mcps.cli main
```

### 3. 在代码中使用
```python
from local_mcps.tender_helper import register_tender_helper_tools
from mcp.server.fastmcp import FastMCP

mcp = FastMCP()
register_tender_helper_tools(mcp)
```

## 完整工作流程

### 步骤1：生成标书大纲
```
使用工具：tender_outline_generator
输入信息：
- 招标项目名称和类型
- 主要技术要求或服务内容  
- 特殊要求或评分重点
- 预算范围和工期要求

输出：JSON格式的详细标书大纲
```

### 步骤2：调整优化大纲（可选）
```
使用工具：tender_outline_adjuster
输入信息：
- 当前大纲JSON
- 具体调整要求
- 调整原因和目标

输出：优化后的标书大纲
```

### 步骤3：创建项目文件结构
```
使用工具：create_tender_project_structure
输入信息：
- 项目名称
- 标书大纲JSON

输出：完整的项目目录和章节文件
```

### 步骤4：生成各章节内容
```
使用工具：tender_content_generator
对每个章节：
- 提供大纲结构
- 指定具体章节
- 说明重点要求
- 提供投标方信息

输出：详细的章节内容（Markdown格式）
```

### 步骤5：合并所有章节
```
使用工具：merge_tender_chapters
输入信息：
- 项目目录路径

输出：完整的标书文档（tender_full.md）
```

### 步骤6：导出Word文档
```
使用工具：export_tender_to_word
输入信息：
- 项目目录路径
- 样式模板选择

输出：专业的Word格式标书（tender_full.docx）
```

## 支持的标书类型

### 🏗️ 工程类标书
- 建筑工程、市政工程、装修工程等
- 重点：施工方案、质量保证、安全措施

### 🛠️ 服务类标书  
- 咨询服务、运维服务、培训服务等
- 重点：服务方案、团队配置、服务承诺

### 📦 货物类标书
- 设备采购、软件采购、材料采购等
- 重点：产品规格、技术参数、售后服务

### 💻 技术类标书
- 软件开发、系统集成、技术方案等
- 重点：技术架构、实施方案、创新点

### 🔄 综合类标书
- 工程+服务、技术+货物等复合类型
- 重点：整体方案、协调配合、风险控制

## 工具列表

| 工具名称 | 功能描述 | 输入 | 输出 |
|---------|---------|------|------|
| `tender_outline_generator` | 生成标书大纲 | 招标需求描述 | JSON格式大纲 |
| `tender_outline_adjuster` | 调整标书大纲 | 大纲JSON + 调整要求 | 优化后大纲 |
| `tender_content_generator` | 生成标书内容 | 大纲 + 章节要求 | Markdown内容 |
| `tender_file_manager` | 管理标书文件 | 文件操作指令 | 操作结果 |
| `tender_word_exporter` | 导出Word文档 | Markdown内容 | Word文档 |
| `create_tender_project_structure` | 创建项目结构 | 项目名 + 大纲JSON | 项目目录 |
| `merge_tender_chapters` | 合并章节内容 | 项目目录路径 | 完整文档 |
| `export_tender_to_word` | 导出Word格式 | 项目目录路径 | Word文档 |

## 使用示例

### 示例：技术类标书编写

```bash
# 1. 生成大纲
使用 tender_outline_generator
项目：智能监控系统集成项目
类型：技术类标书
要求：系统架构设计、设备选型、实施方案

# 2. 创建项目结构  
使用 create_tender_project_structure
项目名：智能监控系统
大纲：步骤1生成的JSON

# 3. 生成各章节内容
使用 tender_content_generator
逐个生成：技术方案、实施计划、质量保证等章节

# 4. 合并和导出
使用 merge_tender_chapters 合并所有章节
使用 export_tender_to_word 导出Word文档
```

## 技术特点

- **🎯 专业性强**：针对标书编写的专门工具，符合行业规范
- **📋 流程完整**：覆盖从大纲到成品的完整编写流程  
- **📁 文件管理**：支持分章节管理，便于团队协作
- **🔄 灵活调整**：支持大纲和内容的灵活调整优化
- **📄 格式规范**：自动生成符合标书规范的Word文档
- **⚡ 高效便捷**：大幅提升标书编写效率和质量

## 适用场景

### 🎯 特别适合的场景
- **大型标书项目**：需要多人协作、分工编写的复杂标书
- **标准化要求高**：政府采购、国企招标等格式要求严格的项目
- **时间紧迫**：需要快速响应、高效编写的紧急标书
- **重复性项目**：可以复用大纲和内容模板的同类项目

### 📋 通用适用场景  
- 各类工程建设项目投标
- 服务外包项目投标
- 设备货物采购投标
- 技术开发项目投标
- 咨询服务项目投标

## 注意事项

- **内容质量**：工具生成的内容需要结合具体项目进行完善
- **格式检查**：导出Word文档后需要检查格式和排版
- **附件管理**：及时上传和管理相关的证书、案例等附件
- **版本控制**：重要修改建议备份，便于版本管理
- **团队协作**：多人编写时注意章节间的协调一致
